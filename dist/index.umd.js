!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("util"),require("amqplib")):"function"==typeof define&&define.amd?define(["util","amqplib"],e):(t||self).knackMq=e(t.util,t.amqplib)}(this,function(t,e){function o(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r=/*#__PURE__*/o(t),n=/*#__PURE__*/o(e);function i(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,s(t,e)}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}var u,c=/*#__PURE__*/function(){function t(t){this.user=void 0,this.password=void 0,this.host=void 0,this.port=void 0,this.vhost=void 0,this.url=void 0,this.user=t.user,this.password=t.password,this.host=t.host,this.port=t.port,this.vhost=t.vhost,this.url=r.default.format("amqp://%s:%s@%s:%s/%s",this.user,this.password,this.host,this.port,this.vhost)}var e=t.prototype;return e.connect=function(t){try{return Promise.resolve(n.default.connect(t)).then(function(t){return Promise.resolve(t.createChannel())})}catch(t){return Promise.reject(t)}},e.send=function(t){try{var e=this;return console.log(" [x] Sent %s",t.data),console.log("[connectionURL]",e.url),Promise.resolve(e.connect(e.url)).then(function(e){console.log("[Channel]",e),e.assertQueue(t.queue,{durable:!0}),e.sendToQueue(t.queue,Buffer.from(t.data))})}catch(t){return Promise.reject(t)}},t}(),a=/*#__PURE__*/function(t){function e(){for(var e,o=arguments.length,r=new Array(o),n=0;n<o;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))||this).queue="email_notification",e}return i(e,t),e.prototype.sendEmail=function(t){this.send({data:t,queue:this.queue})},e}(c),f=/*#__PURE__*/function(t){function e(){return t.apply(this,arguments)||this}return i(e,t),e}(c);return u=f,[a].forEach(function(t){Object.getOwnPropertyNames(t.prototype).forEach(function(e){Object.defineProperty(u.prototype,e,Object.getOwnPropertyDescriptor(t.prototype,e))})}),f});
